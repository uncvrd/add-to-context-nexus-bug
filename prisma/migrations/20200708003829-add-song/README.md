# Migration `20200708003829-add-song`

This migration has been generated by Jordan Lewallen at 7/8/2020, 12:38:29 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TYPE "Status" ADD VALUE 'SIMILAR'

CREATE TABLE "public"."Song" (
"albumId" integer  NOT NULL ,"appleId" integer  NOT NULL ,"id" SERIAL,"isrc" text  NOT NULL ,"previewURL" text  NOT NULL ,"title" text  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."_AlbumToGenre" (
"A" integer  NOT NULL ,"B" integer  NOT NULL )

ALTER TABLE "public"."Album" ADD COLUMN "bgColor" text   ,
ADD COLUMN "copyright" text   ,
ADD COLUMN "editorial" text   ,
ADD COLUMN "recordLabel" text  NOT NULL ;

CREATE UNIQUE INDEX "Song.appleId" ON "public"."Song"("appleId")

CREATE UNIQUE INDEX "Song.isrc" ON "public"."Song"("isrc")

CREATE UNIQUE INDEX "_AlbumToGenre_AB_unique" ON "public"."_AlbumToGenre"("A","B")

CREATE  INDEX "_AlbumToGenre_B_index" ON "public"."_AlbumToGenre"("B")

ALTER TABLE "public"."Song" ADD FOREIGN KEY ("albumId")REFERENCES "public"."Album"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_AlbumToGenre" ADD FOREIGN KEY ("A")REFERENCES "public"."Album"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_AlbumToGenre" ADD FOREIGN KEY ("B")REFERENCES "public"."Genre"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200707203555-add-user-to-album-collection..20200708003829-add-song
--- datamodel.dml
+++ datamodel.dml
@@ -1,15 +1,16 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator prisma_client {
   provider = "prisma-client-js"
 }
 enum Status {
   IN_REVIEW
+  SIMILAR
   APPROVED
   DENIED
 }
@@ -26,18 +27,34 @@
   collection Album[]
 }
 model Album {
-  id       Int      @id @default(autoincrement())
-  title    String
-  uid      String   @unique
-  appleId  Int      @unique
-  date     DateTime
-  imageURL String?
-  artists  Artist[]
-  savedBy  User[]
+  id          Int      @id @default(autoincrement())
+  title       String
+  uid         String   @unique
+  appleId     Int      @unique
+  date        DateTime
+  imageURL    String?
+  bgColor     String?
+  recordLabel String
+  copyright   String?
+  editorial   String?
+  artists     Artist[]
+  savedBy     User[]
+  genres      Genre[]
+  songs       Song[]
 }
+model Song {
+  id         Int @id @default(autoincrement())
+  title      String
+  appleId    Int @unique
+  isrc       String @unique
+  previewURL String
+  albumId    Int
+  album      Album @relation(fields: [albumId], references: [id])
+}
+
 model Artist {
   id        Int     @id @default(autoincrement())
   name      String
   imageURL  String?
@@ -62,5 +79,6 @@
 model Genre {
   id      Int      @id @default(autoincrement())
   name    String   @unique
   artists Artist[]
+  albums  Album[]
 }
```


