# Migration `20200705112621-remove-rumor-to-user-explicit`

This migration has been generated by Jordan Lewallen at 7/5/2020, 11:26:21 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."Rumor" ADD COLUMN "creatorId" integer   ;

ALTER TABLE "public"."RumorToUser" DROP CONSTRAINT IF EXiSTS "RumorToUser_rumorId_fkey";

ALTER TABLE "public"."RumorToUser" DROP CONSTRAINT IF EXiSTS "RumorToUser_userId_fkey";

CREATE UNIQUE INDEX "_RumorToUser_AB_unique" ON "public"."_RumorToUser"("A","B")

CREATE  INDEX "_RumorToUser_B_index" ON "public"."_RumorToUser"("B")

ALTER TABLE "public"."Rumor" ADD FOREIGN KEY ("creatorId")REFERENCES "public"."User"("id") ON DELETE SET NULL  ON UPDATE CASCADE

ALTER TABLE "public"."_RumorToUser" ADD FOREIGN KEY ("A")REFERENCES "public"."Rumor"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_RumorToUser" ADD FOREIGN KEY ("B")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

DROP TABLE "public"."RumorToUser";
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200705104604-add-rumor-to-user-explicit-join..20200705112621-remove-rumor-to-user-explicit
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator prisma_client {
   provider = "prisma-client-js"
@@ -13,17 +13,17 @@
   DENIED
 }
 model User {
-  id        Int           @id @default(autoincrement())
-  uid       String        @unique
-  email     String        @unique
-  username  String        @unique
+  id        Int      @id @default(autoincrement())
+  uid       String   @unique
+  email     String   @unique
+  username  String   @unique
   imageURL  String?
   bio       String?
   artistId  Int?
   following Artist[]
-  rumors    RumorToUser[]
+  rumors    Rumor[]
 }
 model Album {
   id       Int      @id @default(autoincrement())
@@ -46,27 +46,19 @@
   genres    Genre[]
 }
 model Rumor {
-  id      Int           @id @default(autoincrement())
-  title   String
-  date    DateTime
-  status  Status        @default(IN_REVIEW)
-  artists Artist[]
-  backers RumorToUser[]
+  id        Int      @id @default(autoincrement())
+  title     String
+  date      DateTime
+  status    Status   @default(IN_REVIEW)
+  artists   Artist[]
+  backers   User[]
+  creatorId Int?
+  creator   User?     @relation("Creator", fields: [creatorId], references: [id])
 }
 model Genre {
   id      Int      @id @default(autoincrement())
   name    String   @unique
   artists Artist[]
 }
-
-model RumorToUser {
-  rumorId Int
-  rumors  Rumor  @relation(fields: [rumorId], references: [id])
-  userId  Int
-  users   User   @relation(fields: [userId], references: [id])
-  status  Status @default(IN_REVIEW)
-
-  @@id([rumorId, userId])
-}
```


