# Migration `20200705104604-add-rumor-to-user-explicit-join`

This migration has been generated by Jordan Lewallen at 7/5/2020, 10:46:04 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."RumorToUser" (
"rumorId" integer  NOT NULL ,"status" "Status" NOT NULL DEFAULT E'IN_REVIEW',"userId" integer  NOT NULL ,
    PRIMARY KEY ("rumorId","userId"))

ALTER TABLE "public"."_RumorToUser" DROP CONSTRAINT IF EXiSTS "_RumorToUser_A_fkey";

ALTER TABLE "public"."_RumorToUser" DROP CONSTRAINT IF EXiSTS "_RumorToUser_B_fkey";

ALTER TABLE "public"."RumorToUser" ADD FOREIGN KEY ("rumorId")REFERENCES "public"."Rumor"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."RumorToUser" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

DROP TABLE "public"."_RumorToUser";
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200702225548-add-user-bio..20200705104604-add-rumor-to-user-explicit-join
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator prisma_client {
   provider = "prisma-client-js"
@@ -13,17 +13,17 @@
   DENIED
 }
 model User {
-  id            Int      @id @default(autoincrement())
-  uid           String   @unique
-  email         String   @unique
-  username      String   @unique
-  imageURL      String?
-  bio           String?  
-  artistId      Int?
-  following     Artist[]
-  contributions Rumor[]
+  id        Int           @id @default(autoincrement())
+  uid       String        @unique
+  email     String        @unique
+  username  String        @unique
+  imageURL  String?
+  bio       String?
+  artistId  Int?
+  following Artist[]
+  rumors    RumorToUser[]
 }
 model Album {
   id       Int      @id @default(autoincrement())
@@ -46,17 +46,27 @@
   genres    Genre[]
 }
 model Rumor {
-  id      Int      @id @default(autoincrement())
+  id      Int           @id @default(autoincrement())
   title   String
   date    DateTime
-  status  Status   @default(IN_REVIEW)
+  status  Status        @default(IN_REVIEW)
   artists Artist[]
-  backers User[]
+  backers RumorToUser[]
 }
 model Genre {
-  id Int @id @default(autoincrement())
-  name String @unique
+  id      Int      @id @default(autoincrement())
+  name    String   @unique
   artists Artist[]
 }
+
+model RumorToUser {
+  rumorId Int
+  rumors  Rumor  @relation(fields: [rumorId], references: [id])
+  userId  Int
+  users   User   @relation(fields: [userId], references: [id])
+  status  Status @default(IN_REVIEW)
+
+  @@id([rumorId, userId])
+}
```


